---
layout: post
title: Use exists? to check if a record exists or not
---
You want to know if a record exists with the email address 'john@example.com' or not? Most common implementation I see is this

{% highlight ruby %}
if User.find(:first, :conditions => ["email =?",'john@example.com'])
  # ..
end
{% endhighlight %}

Above solution works but it is not a very good solution. A better solution would be 

{% highlight ruby %}
if User.exists?(["email =?",'john@example.com'])
  # ..
end
{% endhighlight %}

h2. Why exists? is a better solution

When you perform <tt>User.find(:first, :conditions => {})</tt> then a sql statement is issued. But ,more importantly, if a record is found then a model instance is created. Well ,in this particular case, the intent was just to check if a record exists or not. All the cost associated with instantiating the found record is wasted.

When you use <tt>User.exists?</tt> method then a sql statement is issued and depending on the result either true or false is returned. An instance of the model is NOT created even if a record is found. So using <tt>User.exists?</tt> saves the cost associated with model creation.

The second reason why <tt>User.exists?</tt> is a better solution is because it lets others know the intent of the programmer. <tt>User.exists?</tt> clearly tells that all  I care is whether a record exists or not. Compare that to <tt>if User.find()</tt> does not tell much about the intent of the programmer.


h2. How do you detect if a record is instantiated or not

The sql statement generated by both <tt>User.first()</tt> and <tt>User.exists?</tt> is same. So someone asked how did I find out in one case a model was getting instantiated.

callback <tt>after_initialize</tt> to rescue. Any time a model is instantiated Rails invokes a method called <tt>after_initialize</tt> . To see the different put this method in your model .

{% highlight ruby %}
def after_initialize
  puts "initialized"
end
{% endhighlight %}

Now in your script/console you will see the "initialized" message when an instance of the model is created.
 <br />
